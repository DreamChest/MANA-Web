%nav.navbar.navbar-default.navbar-fixed-top
  %a.navbar-brand.glyphicon.glyphicon-menu-down.neveractive#sidebar-toggle{href: ""}
  %a.navbar-brand.glyphicon.glyphicon-menu-down.pull-right.neveractive#sidebar-toggle-right{href: ""}
  .container
    .navbar-header
      %button{ class: "navbar-toggle", data: { toggle: "collapse", target: "#navbar" } }
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      %a.navbar-brand{href: root_url} MANA

    .collapse.navbar-collapse#navbar
      %ul.nav.navbar-nav
        %li= link_to t("words.entry", count: 2), entries_path, class: "dyn"
        %li= link_to t("words.source", count: 2), sources_path, class: "dyn"
        %li= link_to t("words.tag", count: 2), tags_path, class: "dyn"

      %ul.nav.navbar-nav.navbar-right
        %li= link_to "", update_sources_url, class: "glyphicon glyphicon-refresh dyn neveractive redirect"
        %li.dropdown
          %a{ class: "dropdown-toggle", data: { toggle: "dropdown", href: "#"} }
            = t("words.lang")
            %span.caret
          %ul.dropdown-menu
            %li= link_to "English", "?locale=en"
            %li= link_to "Fran√ßais", "?locale=fr"

:javascript
  function set_active() {
    var loc = location.pathname;
    if(loc=="/") loc = "/entries";

    $('.nav').find(".active").removeClass('active');
    $('.nav a[href^="'+loc+'"]').closest('li').addClass('active');
  }

  $(document).ready(function() {
    set_active();

    $(".nav a").not(".neveractive").click(function() {
      $(".nav").find(".active").removeClass("active");
      $(".sidebar-nav").find(".active").removeClass("active");
      $(this).parent().addClass("active");
    });

    $(".redirect").click(function() {
      set_active();
    });

    $("#sidebar-toggle").click(function() {
      $("#wrapper").toggleClass("toggled");
      return false;
    });

    $("#sidebar-toggle-right").click(function() {
      $("#wrapper").toggleClass("toggled-right");
      return false;
    });
  });
