%nav.navbar.navbar-default
  .container-fluid
    .navbar-header
      %button{ class: "navbar-toggle", data: { toggle: "collapse", target: "#navbar" } }
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      %a.navbar-brand{href: root_url} MANA

    .collapse.navbar-collapse#navbar
      %ul.nav.navbar-nav
        %li= link_to t("words.entry", count: 2), entries_path, class: "dyn"
        %li= link_to t("words.source", count: 2), sources_path, class: "dyn"
        %li= link_to t("words.tag", count: 2), tags_path, class: "dyn"

      %ul.nav.navbar-nav.navbar-right
        %li= link_to "", update_sources_url, class: "glyphicon glyphicon-refresh dyn", id: "refresh"
        %li.dropdown
          %a{ class: "dropdown-toggle", data: { toggle: "dropdown", href: "#"} }
            = t("words.lang")
            %span.caret
          %ul.dropdown-menu
            %li= link_to "English", "?locale=en"
            %li= link_to "Fran√ßais", "?locale=fr"

:javascript
  function set_active() {
    var loc = location.pathname;
    if(loc=="/") loc = "/entries";

    $('.nav').find(".active").removeClass('active');
    $('a[href^="'+loc+'"]').closest('li').addClass('active');
  }

  $(document).ready(function() {
    set_active();

    $(".nav a").click(function() {
      $(".nav").find(".active").removeClass("active");
      $(this).parent().addClass("active");
    });

    $("#refresh").click(function() {
      set_active();
    });
  });
